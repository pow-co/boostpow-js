"use strict"
const expect = require("chai").expect
const index = require("..")

describe("test from raw transaction", () => {

  const proofs = [
    {
      "redeem":"0200000001c038a1ba98c15e51f4a09a89e2b10259b1a6b999860330c7e83600e9b78b11eb000000008247304402202f9ae17740b8587973dd02786b65f8be8c2ffd2fda4fd15278c7ea7367e6d37e0220438a5201971e481813b2f7db9f899c7927795c1f1468d07735bf12298bb2b45341210202709cbf90a46e3e2c5a92e9c37b8ed21fc0c7d0e62c34fb60dfdf4474691142040a4702000416eae863087d4f7b2637adb98d04d09edca5ffffffff0183030000000000001976a9145cf17d43386b04015f5e6df6149901f710efb3e088ac00000000", "spend":"01000000021d2ccda35355dbe15f33f9d285c4b989ee13b7f79f957e1dc862d9b6b3f6f8a1010000006b4830450221008657765a30ba3e2b03afccecca6308950d0b8d00916b01ddf3072014c38f47dc022069068d7f8b3076b6d1069cbfa453d0488bfad3ff6f8c4de2f95b6887cf95bb9e41210320a9af25b3c658da8172b8f2b983631122e8ce1a48ebca0c1a685ead129691c9ffffffffddee768a52a183e8f87f05b15705001655c07a428c9e15417a28d87b6840010a000000006a47304402207dc7a66f6ecaca949c858d0e5045599ada6c7905ae54fba0feb1e25de1c3c51e022043eb303b24af1da90ec46bf735776dfc56cf8381182552ca237b1311c292ee7f41210320a9af25b3c658da8172b8f2b983631122e8ce1a48ebca0c1a685ead129691c9ffffffff02e803000000000000c608626f6f7374706f7775145cf17d43386b04015f5e6df6149901f710efb3e00400000000208f6e303fc6ed840207e44b7cbf609c72076b68c6b32f8a2ac71eae178a378e23049e86011f04796f6761049d885b6b007e7c557a766b7e52796b557a8254887e557a8258887e7c7eaa7c6b7e7e7c8254887e6c7e7c8254887eaa01007e816c825488537f7681530121a5696b768100a0691d00000000000000000000000000000000000000000000000000000000007e6c539458959901007e819f6976a96c88ac0a262500000000001976a914f8c8ea089583cecf1212ebc7e76adbac1b8fc26d88ac00000000"
    },
    {
      "redeem":"0200000001377df06f0abc56b2c0c5b247149a79ffe6863590e73b9c615f4dc89369e142cf000000008247304402202754bc748f72fdebeaf679ab18abeec5506c4b5618b4520e0cef36593eac644202205930624fb55af4c2692709d992b786b5d4da883f889f6f74500fdad44521dbd841210202709cbf90a46e3e2c5a92e9c37b8ed21fc0c7d0e62c34fb60dfdf4474691142047d720000041fede8630832121a58abf77c5a04b14e130affffffff0183030000000000001976a9145cf17d43386b04015f5e6df6149901f710efb3e088ac00000000", "spend":"0100000001c038a1ba98c15e51f4a09a89e2b10259b1a6b999860330c7e83600e9b78b11eb010000006b483045022100ffad1123a485440b5077bd9ff908bc06257dfde68fa3aa8b90b853d1ba2b3ee702202b291dd9db3a048c0a57c57d9036092518d563aa49d28030dae6801c09794c0241210320a9af25b3c658da8172b8f2b983631122e8ce1a48ebca0c1a685ead129691c9ffffffff02e803000000000000c608626f6f7374706f7775145cf17d43386b04015f5e6df6149901f710efb3e00400000000208f6e303fc6ed840207e44b7cbf609c72076b68c6b32f8a2ac71eae178a378e23049e86011f04796f67610406ba0589007e7c557a766b7e52796b557a8254887e557a8258887e7c7eaa7c6b7e7e7c8254887e6c7e7c8254887eaa01007e816c825488537f7681530121a5696b768100a0691d00000000000000000000000000000000000000000000000000000000007e6c539458959901007e819f6976a96c88ac0e222500000000001976a914f8c8ea089583cecf1212ebc7e76adbac1b8fc26d88ac00000000"
    },
    {
      "redeem":"02000000018ae6be49a647c5cf93e65ca311017ca78d4e0f89d0f73cbe8498d720510f59ab0000000083483045022100a714c60b7c64e39f079853084c077f64d7085b7be706a97d2b141888ef46cb8402200b856b51a48f2199ed3855189091f864540f574da411fdf5e7ccf7dda7ca4fcc41210202709cbf90a46e3e2c5a92e9c37b8ed21fc0c7d0e62c34fb60dfdf447469114204ae1c0000049defe8630876acfae0633100d704872960baffffffff0183030000000000001976a9145cf17d43386b04015f5e6df6149901f710efb3e088ac00000000", "spend":"0100000001377df06f0abc56b2c0c5b247149a79ffe6863590e73b9c615f4dc89369e142cf010000006b4830450221008f8670c7c0d0e0b561ec12a951371e5a81c503e0d8a30de12f13b8d241cd16410220613231d6a3507ed6158ceafbffdee329a29a777405638f8e10006a0d7179704441210320a9af25b3c658da8172b8f2b983631122e8ce1a48ebca0c1a685ead129691c9ffffffff02e803000000000000c608626f6f7374706f7775145cf17d43386b04015f5e6df6149901f710efb3e00400000000208f6e303fc6ed840207e44b7cbf609c72076b68c6b32f8a2ac71eae178a378e23049e86011f04796f67610478153972007e7c557a766b7e52796b557a8254887e557a8258887e7c7eaa7c6b7e7e7c8254887e6c7e7c8254887eaa01007e816c825488537f7681530121a5696b768100a0691d00000000000000000000000000000000000000000000000000000000007e6c539458959901007e819f6976a96c88ac121e2500000000001976a914f8c8ea089583cecf1212ebc7e76adbac1b8fc26d88ac00000000"
    },
    {
      "redeem":"0100000005668d9dccbcb2f188b3f83d773d50759d2f1f0713393f6fac7583e6c2f53b1580000000009747304402207a25c6f90787d8837d068549622795d0fb048e370327ef4bda8e5c15e2eb5983022004ff410f11de1674cb049436d1065e0b34e5586aa6ba7f39f85e6e7c296c96d1412103bd13775e960445aa7abf5d717593ebe0bda282410e3d20eac8622cb935f5a58a0495f51900043c71b46308b50ed919ef65d66c0426ebddfb149a1b49908fc8730ea073ead3af8e8af45d93932dffffffffa567fa0ea2c7092d77c5d3ebf67dd4f5bce015fe6bc3407e4e07691ec76a4f800000000097473044022047b9391af851c05152ec5a0d4f1294cd01345184edfac807f6c849bb8b3e4589022067a5f5336e04eef8ca9312c69cb2ae1a708e57ee4197eb70b5f95eb64d37b025412103bd13775e960445aa7abf5d717593ebe0bda282410e3d20eac8622cb935f5a58a0495f51900043c71b46308b50ed919ef65d66c0426ebddfb149a1b49908fc8730ea073ead3af8e8af45d93932dffffffff9c538a58136ec5f436b3db84c63b75445a02d0452857eccf31a87b6708a2fd900000000097473044022036729715c6f854d2fecd173cf450760d64e6158201f0b68ad7c6c024a4acbb2c022026c7f6cb8afe5433a982e4116529335cbaf70162f75198e483152896c23b0c9f412103bd13775e960445aa7abf5d717593ebe0bda282410e3d20eac8622cb935f5a58a0495f51900043c71b46308b50ed919ef65d66c0426ebddfb149a1b49908fc8730ea073ead3af8e8af45d93932dffffffff63c5256bc6ef750fd32e64a87d5461e797855dab19e3eb56f2ed4880b6fc14f0000000009747304402204e7772f9b5211997dbc32de1a2c1c43a98b5e7d2248ea7a86789b049e930200402200639e3d1370add57706297caa4dc6affa3b86383ea403af03adf9d29c9e1d267412103bd13775e960445aa7abf5d717593ebe0bda282410e3d20eac8622cb935f5a58a0495f51900043c71b46308b50ed919ef65d66c0426ebddfb149a1b49908fc8730ea073ead3af8e8af45d93932dffffffff1c56ae5473886e002acdd3da9c07fedc1923d5f9c2feedd9c6deb32f5bc17efc00000000984830450221009aa9e391f59f2556f335205e03b4a88197c499bba17bb64994dd027bed10fc6c02205efd9af9f4aaecb60c4636bba12db25316babcf36fcf11197dd992f7f49ffad7412103bd13775e960445aa7abf5d717593ebe0bda282410e3d20eac8622cb935f5a58a0495f51900043c71b46308b50ed919ef65d66c0426ebddfb149a1b49908fc8730ea073ead3af8e8af45d93932dffffffff019d121300000000001976a914cbbf71f14b1fff09dc3e429d97c95a438cd0799688ac00000000", "spend":"01000000031827a0ceee887b0fec96fa03357f8895f75f1e09b03afd344f526dbcb3d08fc0020000006b483045022100ef11dbf38792fd061972738b1b2cd09285ff450d557223c906d3e404378754bf02205f82681ae4c17f3e95022f0c06ab0055e712df1dff6bf5f968a37e4b5ca3f31d412102eba9556f210d6d4b0d3c2e0f95b77c82f411b38e914987da1b6e0b8062592868ffffffff1827a0ceee887b0fec96fa03357f8895f75f1e09b03afd344f526dbcb3d08fc0030000006b483045022100c522b56b495a9d53408b7584a9d8c25285bccbecee93024dff0dff13a093223902202dae9d280fdb629392af618f7347d698f06e45c69046ba28d4b6e9dd0597cc30412102eba9556f210d6d4b0d3c2e0f95b77c82f411b38e914987da1b6e0b8062592868ffffffffce6745b2358a0f8351dc388914af3173db6ec3362c971c692d9851149ff561cb050000006a47304402200b37a8863b40a460eefdaf1bd55f8f9b85708558fb34b02a79f3955ce5b73b0e02207cd707587b8af534c7e4dbbbe6838e7aec55f643e7881f68278b3630ebdc60c1412102eba9556f210d6d4b0d3c2e0f95b77c82f411b38e914987da1b6e0b8062592868ffffffff0390d0030000000000ad08626f6f7374706f77750400000000203800f4e6e442185ce67113c52c55e61c9d5a4ac2eb2db62b1db422057cfe7ebd04d8ff271d0004f83163b8007e7c557a766b7e52796b557a8254887e557a8258887e7c7eaa7c6b7e7e7c8254887e6c7e7c8254887eaa01007e816c825488537f7681530121a5696b768100a0691d00000000000000000000000000000000000000000000000000000000007e6c539458959901007e819f6976a96c88ac00000000000000002f006a2231487948587459577947655072485669736e4e645339333156743643716f7555795a0972656c6179782e696f0ca00100000000001976a914b8f11fc51ba572f0d4404d3820d9ae9247acd71188ac00000000"
    },
    {
      "redeem":"0100000005668d9dccbcb2f188b3f83d773d50759d2f1f0713393f6fac7583e6c2f53b1580000000009747304402207a25c6f90787d8837d068549622795d0fb048e370327ef4bda8e5c15e2eb5983022004ff410f11de1674cb049436d1065e0b34e5586aa6ba7f39f85e6e7c296c96d1412103bd13775e960445aa7abf5d717593ebe0bda282410e3d20eac8622cb935f5a58a0495f51900043c71b46308b50ed919ef65d66c0426ebddfb149a1b49908fc8730ea073ead3af8e8af45d93932dffffffffa567fa0ea2c7092d77c5d3ebf67dd4f5bce015fe6bc3407e4e07691ec76a4f800000000097473044022047b9391af851c05152ec5a0d4f1294cd01345184edfac807f6c849bb8b3e4589022067a5f5336e04eef8ca9312c69cb2ae1a708e57ee4197eb70b5f95eb64d37b025412103bd13775e960445aa7abf5d717593ebe0bda282410e3d20eac8622cb935f5a58a0495f51900043c71b46308b50ed919ef65d66c0426ebddfb149a1b49908fc8730ea073ead3af8e8af45d93932dffffffff9c538a58136ec5f436b3db84c63b75445a02d0452857eccf31a87b6708a2fd900000000097473044022036729715c6f854d2fecd173cf450760d64e6158201f0b68ad7c6c024a4acbb2c022026c7f6cb8afe5433a982e4116529335cbaf70162f75198e483152896c23b0c9f412103bd13775e960445aa7abf5d717593ebe0bda282410e3d20eac8622cb935f5a58a0495f51900043c71b46308b50ed919ef65d66c0426ebddfb149a1b49908fc8730ea073ead3af8e8af45d93932dffffffff63c5256bc6ef750fd32e64a87d5461e797855dab19e3eb56f2ed4880b6fc14f0000000009747304402204e7772f9b5211997dbc32de1a2c1c43a98b5e7d2248ea7a86789b049e930200402200639e3d1370add57706297caa4dc6affa3b86383ea403af03adf9d29c9e1d267412103bd13775e960445aa7abf5d717593ebe0bda282410e3d20eac8622cb935f5a58a0495f51900043c71b46308b50ed919ef65d66c0426ebddfb149a1b49908fc8730ea073ead3af8e8af45d93932dffffffff1c56ae5473886e002acdd3da9c07fedc1923d5f9c2feedd9c6deb32f5bc17efc00000000984830450221009aa9e391f59f2556f335205e03b4a88197c499bba17bb64994dd027bed10fc6c02205efd9af9f4aaecb60c4636bba12db25316babcf36fcf11197dd992f7f49ffad7412103bd13775e960445aa7abf5d717593ebe0bda282410e3d20eac8622cb935f5a58a0495f51900043c71b46308b50ed919ef65d66c0426ebddfb149a1b49908fc8730ea073ead3af8e8af45d93932dffffffff019d121300000000001976a914cbbf71f14b1fff09dc3e429d97c95a438cd0799688ac00000000", "spend":"01000000033df5f2b50693489bf31f6025e6c4f09bdd0339b644e7cf48fb0747a3e085b0ab030000006a47304402200abbebdfa09ef226d497f6e47e661f3d6fdcf03c7cf26cc504b860e72eeeaa9702200f24e66939a78781c6b994bad7b3fc5b63b4faa3151424c12fbe148e2c705103412102eba9556f210d6d4b0d3c2e0f95b77c82f411b38e914987da1b6e0b8062592868ffffffffce6745b2358a0f8351dc388914af3173db6ec3362c971c692d9851149ff561cb030000006b483045022100a9662f27db6b78361bae584f2e48f236cb7f89bc8599b2102a2f8cbf3a7f23f802206e8e013c4df7efb3117acefc92c45aaff67a3e1770757aed12e626f3972260bc412102eba9556f210d6d4b0d3c2e0f95b77c82f411b38e914987da1b6e0b8062592868ffffffffce6745b2358a0f8351dc388914af3173db6ec3362c971c692d9851149ff561cb020000006b483045022100aaec19612f2dfed70c83a09309c75bb311eae3fbe2ec0913f8d0ccdef3ab203a02206dd64bd2c2527ab29e50d430d157b727c524c64e0c3e777b232c92ae28a04442412102eba9556f210d6d4b0d3c2e0f95b77c82f411b38e914987da1b6e0b8062592868ffffffff0390d0030000000000ad08626f6f7374706f77750400000000203800f4e6e442185ce67113c52c55e61c9d5a4ac2eb2db62b1db422057cfe7ebd04d8ff271d0004f83163b8007e7c557a766b7e52796b557a8254887e557a8258887e7c7eaa7c6b7e7e7c8254887e6c7e7c8254887eaa01007e816c825488537f7681530121a5696b768100a0691d00000000000000000000000000000000000000000000000000000000007e6c539458959901007e819f6976a96c88ac00000000000000002f006a2231487948587459577947655072485669736e4e645339333156743643716f7555795a0972656c6179782e696f2ba00100000000001976a914b8f11fc51ba572f0d4404d3820d9ae9247acd71188ac00000000"
    },
    {
      "redeem":"0100000005668d9dccbcb2f188b3f83d773d50759d2f1f0713393f6fac7583e6c2f53b1580000000009747304402207a25c6f90787d8837d068549622795d0fb048e370327ef4bda8e5c15e2eb5983022004ff410f11de1674cb049436d1065e0b34e5586aa6ba7f39f85e6e7c296c96d1412103bd13775e960445aa7abf5d717593ebe0bda282410e3d20eac8622cb935f5a58a0495f51900043c71b46308b50ed919ef65d66c0426ebddfb149a1b49908fc8730ea073ead3af8e8af45d93932dffffffffa567fa0ea2c7092d77c5d3ebf67dd4f5bce015fe6bc3407e4e07691ec76a4f800000000097473044022047b9391af851c05152ec5a0d4f1294cd01345184edfac807f6c849bb8b3e4589022067a5f5336e04eef8ca9312c69cb2ae1a708e57ee4197eb70b5f95eb64d37b025412103bd13775e960445aa7abf5d717593ebe0bda282410e3d20eac8622cb935f5a58a0495f51900043c71b46308b50ed919ef65d66c0426ebddfb149a1b49908fc8730ea073ead3af8e8af45d93932dffffffff9c538a58136ec5f436b3db84c63b75445a02d0452857eccf31a87b6708a2fd900000000097473044022036729715c6f854d2fecd173cf450760d64e6158201f0b68ad7c6c024a4acbb2c022026c7f6cb8afe5433a982e4116529335cbaf70162f75198e483152896c23b0c9f412103bd13775e960445aa7abf5d717593ebe0bda282410e3d20eac8622cb935f5a58a0495f51900043c71b46308b50ed919ef65d66c0426ebddfb149a1b49908fc8730ea073ead3af8e8af45d93932dffffffff63c5256bc6ef750fd32e64a87d5461e797855dab19e3eb56f2ed4880b6fc14f0000000009747304402204e7772f9b5211997dbc32de1a2c1c43a98b5e7d2248ea7a86789b049e930200402200639e3d1370add57706297caa4dc6affa3b86383ea403af03adf9d29c9e1d267412103bd13775e960445aa7abf5d717593ebe0bda282410e3d20eac8622cb935f5a58a0495f51900043c71b46308b50ed919ef65d66c0426ebddfb149a1b49908fc8730ea073ead3af8e8af45d93932dffffffff1c56ae5473886e002acdd3da9c07fedc1923d5f9c2feedd9c6deb32f5bc17efc00000000984830450221009aa9e391f59f2556f335205e03b4a88197c499bba17bb64994dd027bed10fc6c02205efd9af9f4aaecb60c4636bba12db25316babcf36fcf11197dd992f7f49ffad7412103bd13775e960445aa7abf5d717593ebe0bda282410e3d20eac8622cb935f5a58a0495f51900043c71b46308b50ed919ef65d66c0426ebddfb149a1b49908fc8730ea073ead3af8e8af45d93932dffffffff019d121300000000001976a914cbbf71f14b1fff09dc3e429d97c95a438cd0799688ac00000000", "spend":"0100000003b40695aebf028935ee283fdb07e0cd5f9ec6f5152b463e369f67532e99dee166030000006a473044022007fb13a012580fd16de232723ca80c641c9e94557b362208c048eea0daa5880c02203f89842f5d199d34b4b324ef62cd4bfc524520d512a203fe1c48d3677a130eac412102eba9556f210d6d4b0d3c2e0f95b77c82f411b38e914987da1b6e0b8062592868ffffffffd634c9063eaa98fa04599e59f1c2218185d7c5d04b3627eae3fe2c837193e60b030000006b483045022100b97f88fad5bcc2bd977ddea39e709559b51088e10f560f5d6042208669bafd0702201d534724ddebe47b5246826314cd7dd101d2063fd91997e6e25f59beeea2042e412102eba9556f210d6d4b0d3c2e0f95b77c82f411b38e914987da1b6e0b8062592868ffffffff3df5f2b50693489bf31f6025e6c4f09bdd0339b644e7cf48fb0747a3e085b0ab040000006b483045022100a027d3313eb0d5f2d5b5cc9628ab15f3ec433035de0059f284027d271a9f128002201623cf4671ffb61f5ab63cb0b3431fee2eed2daac316ec5365ef4bc3c851f44e412102eba9556f210d6d4b0d3c2e0f95b77c82f411b38e914987da1b6e0b8062592868ffffffff0390d0030000000000ad08626f6f7374706f77750400000000203800f4e6e442185ce67113c52c55e61c9d5a4ac2eb2db62b1db422057cfe7ebd04d8ff271d0004f83163b8007e7c557a766b7e52796b557a8254887e557a8258887e7c7eaa7c6b7e7e7c8254887e6c7e7c8254887eaa01007e816c825488537f7681530121a5696b768100a0691d00000000000000000000000000000000000000000000000000000000007e6c539458959901007e819f6976a96c88ac00000000000000002f006a2231487948587459577947655072485669736e4e645339333156743643716f7555795a0972656c6179782e696f49a00100000000001976a914b8f11fc51ba572f0d4404d3820d9ae9247acd71188ac00000000"
    },
    {
      "redeem":"0100000005668d9dccbcb2f188b3f83d773d50759d2f1f0713393f6fac7583e6c2f53b1580000000009747304402207a25c6f90787d8837d068549622795d0fb048e370327ef4bda8e5c15e2eb5983022004ff410f11de1674cb049436d1065e0b34e5586aa6ba7f39f85e6e7c296c96d1412103bd13775e960445aa7abf5d717593ebe0bda282410e3d20eac8622cb935f5a58a0495f51900043c71b46308b50ed919ef65d66c0426ebddfb149a1b49908fc8730ea073ead3af8e8af45d93932dffffffffa567fa0ea2c7092d77c5d3ebf67dd4f5bce015fe6bc3407e4e07691ec76a4f800000000097473044022047b9391af851c05152ec5a0d4f1294cd01345184edfac807f6c849bb8b3e4589022067a5f5336e04eef8ca9312c69cb2ae1a708e57ee4197eb70b5f95eb64d37b025412103bd13775e960445aa7abf5d717593ebe0bda282410e3d20eac8622cb935f5a58a0495f51900043c71b46308b50ed919ef65d66c0426ebddfb149a1b49908fc8730ea073ead3af8e8af45d93932dffffffff9c538a58136ec5f436b3db84c63b75445a02d0452857eccf31a87b6708a2fd900000000097473044022036729715c6f854d2fecd173cf450760d64e6158201f0b68ad7c6c024a4acbb2c022026c7f6cb8afe5433a982e4116529335cbaf70162f75198e483152896c23b0c9f412103bd13775e960445aa7abf5d717593ebe0bda282410e3d20eac8622cb935f5a58a0495f51900043c71b46308b50ed919ef65d66c0426ebddfb149a1b49908fc8730ea073ead3af8e8af45d93932dffffffff63c5256bc6ef750fd32e64a87d5461e797855dab19e3eb56f2ed4880b6fc14f0000000009747304402204e7772f9b5211997dbc32de1a2c1c43a98b5e7d2248ea7a86789b049e930200402200639e3d1370add57706297caa4dc6affa3b86383ea403af03adf9d29c9e1d267412103bd13775e960445aa7abf5d717593ebe0bda282410e3d20eac8622cb935f5a58a0495f51900043c71b46308b50ed919ef65d66c0426ebddfb149a1b49908fc8730ea073ead3af8e8af45d93932dffffffff1c56ae5473886e002acdd3da9c07fedc1923d5f9c2feedd9c6deb32f5bc17efc00000000984830450221009aa9e391f59f2556f335205e03b4a88197c499bba17bb64994dd027bed10fc6c02205efd9af9f4aaecb60c4636bba12db25316babcf36fcf11197dd992f7f49ffad7412103bd13775e960445aa7abf5d717593ebe0bda282410e3d20eac8622cb935f5a58a0495f51900043c71b46308b50ed919ef65d66c0426ebddfb149a1b49908fc8730ea073ead3af8e8af45d93932dffffffff019d121300000000001976a914cbbf71f14b1fff09dc3e429d97c95a438cd0799688ac00000000", "spend":"0100000003d634c9063eaa98fa04599e59f1c2218185d7c5d04b3627eae3fe2c837193e60b020000006a473044022037064028dde414fe478e44e7fa3c48d93adc1607f3ba73b4df02cf2e01bc7b6d02206227ed558409a7c4b51285ae4df760337955c14d9c1b383204360f36d8a1b74a412102eba9556f210d6d4b0d3c2e0f95b77c82f411b38e914987da1b6e0b8062592868ffffffffb40695aebf028935ee283fdb07e0cd5f9ec6f5152b463e369f67532e99dee166040000006a4730440220499213a529ccc357bf3fe71d17a95850a442171cf5c7d4823e9847b38f1620b4022015e7a9c08ba5c5d0bb656d93bc7f3ddb22e7364cddb2933fea2df8884b313cf6412102eba9556f210d6d4b0d3c2e0f95b77c82f411b38e914987da1b6e0b8062592868ffffffffd634c9063eaa98fa04599e59f1c2218185d7c5d04b3627eae3fe2c837193e60b050000006b483045022100d0d7a265c70215c5eb374bf07b761a2ee4efa76b237ebf0289df583e93da6fc7022014eb229a72bef174bc217f4cc5335eb510d7fe3c949543a1b1e463b1cea9e71c412102eba9556f210d6d4b0d3c2e0f95b77c82f411b38e914987da1b6e0b8062592868ffffffff0390d0030000000000ad08626f6f7374706f77750400000000203800f4e6e442185ce67113c52c55e61c9d5a4ac2eb2db62b1db422057cfe7ebd04d8ff271d0004f83163b8007e7c557a766b7e52796b557a8254887e557a8258887e7c7eaa7c6b7e7e7c8254887e6c7e7c8254887eaa01007e816c825488537f7681530121a5696b768100a0691d00000000000000000000000000000000000000000000000000000000007e6c539458959901007e819f6976a96c88ac00000000000000002f006a2231487948587459577947655072485669736e4e645339333156743643716f7555795a0972656c6179782e696f17a00100000000001976a914b8f11fc51ba572f0d4404d3820d9ae9247acd71188ac00000000"
    },
    {
      "redeem":"01000000027aae97b56fa625b42284640ea0e99d89b375237979bde6301244f9c395d4b9020000000098483045022100c81a0094752e1fa9e6bc77af39bfeaddcbb471ab0024190384a2219d5e0e57a7022000d113c22fdd6de04c4aee0b9b30fe62809f53a6e49dbffc30159b8bb15358fd412102c8e88051a9bc1829dbefdab1855e81b14ed02fc268b518660a1d031eef4a3754042f2d000004c987a46308acc53188595be95d042362fe2914808a68fe1c1d4463c87f98bedcbcc52c45b5374cffffffff99bb907c3a9667c8495e15e4de4bc5495402e1987f95f925eaeb7343e2c703ca00000000974730440220198a26adfb3ed69e2088a2811bd8f92a030b46f5cfc0a24aaa9b40eeea276210022025525666eb3448535fff16c25f94add29986312b91a0dfef228831e921c52d3d412102c8e88051a9bc1829dbefdab1855e81b14ed02fc268b518660a1d031eef4a3754042f2d000004c987a46308acc53188595be95d042362fe2914808a68fe1c1d4463c87f98bedcbcc52c45b5374cffffffff01aac80300000000001976a9141402f0ea4fb8cb9f0bf5629da25743b4576f35e788ac00000000", "spend":"0100000001ff624d370a9fb1498bd2e2d7f76bfed3208ea2571243c2717ac31054c938e382040000006a473044022005da7737ff2642fae8671eec6d82dd70c4254b6b24dcc8d78305f9f0bdd423a00220445d1a0485483d7c2ff56d49fc2aed21be3775a0d1cef691ab985a41c63bfa9741210381ca796dba9f4d3bd09bd4df28ea2e86ca43819aae4599bff9ba4cc3d3cf5d6effffffff0a60e4010000000000ad08626f6f7374706f777504000000002094546cf8780cffcbbded1db50fc02ef3b259be317a95924ece512b746f3be6c304d8ff271d000403a4f4c3007e7c557a766b7e52796b557a8254887e557a8258887e7c7eaa7c6b7e7e7c8254887e6c7e7c8254887eaa01007e816c825488537f7681530121a5696b768100a0691d00000000000000000000000000000000000000000000000000000000007e6c539458959901007e819f6976a96c88ac00000000000000002f006a2231487948587459577947655072485669736e4e645339333156743643716f7555795a0972656c6179782e696f886f0200000000001976a9146c47002bc3c6cd85a833f5c15c8305b36591c38b88ac846f0200000000001976a9146c47002bc3c6cd85a833f5c15c8305b36591c38b88ac9e6f0200000000001976a9146c47002bc3c6cd85a833f5c15c8305b36591c38b88ac8e6f0200000000001976a9146c47002bc3c6cd85a833f5c15c8305b36591c38b88ac786f0200000000001976a9146c47002bc3c6cd85a833f5c15c8305b36591c38b88ac846f0200000000001976a9146c47002bc3c6cd85a833f5c15c8305b36591c38b88ac926f0200000000001976a9146c47002bc3c6cd85a833f5c15c8305b36591c38b88acc7700200000000001976a9146c47002bc3c6cd85a833f5c15c8305b36591c38b88ac00000000"
    },
    {
      "redeem":"01000000023612c921e2818469c43830e5f6a48821e0cb64aa5818a876af672f966a04391000000000984830450221008db95f37bdcb244de3f107676ae8ca1bec5855c2f553bf5f842437d66824adb102201db68ab5ec69ebed2889caef18ef0994a918cf520d35e5da1acf420f6acaeba5412102f7cb3418d5e188a3984d4ab184a45b8d6df090e00527fafa310b166cc98dbe9504f4ee1300048f76c4630849fff78f5fad507b04481fba8f14e2db8bda89e1c7f85df8c75227818c654c035f1fffffffffd02ca29df3202b60a7a0102e1d82e0781ce4c1d78a31dc5f86eea49a46a6541900000000974730440220510e3404a8f270055a0df6ca73c87d1f234eaae23176a98ddde9ad88795644f702202f6c49c97e76ea23fc8ad4b7071720cbd0957db01146efa51b976069b2b0eb8d412102f7cb3418d5e188a3984d4ab184a45b8d6df090e00527fafa310b166cc98dbe9504f4ee1300048f76c4630849fff78f5fad507b04481fba8f14e2db8bda89e1c7f85df8c75227818c654c035f1fffffffff01aac80300000000001976a914ec50088a9271abe3eab7cc66ae390028ab083a5088ac00000000", "spend":"01000000019acf5ec84bd27c36d4540e1f6d1ba1270e4b31547615d97577b489dc9b9125cb070000006b483045022100cf406a5f1fd0c38bad14143858a236b61acea8a4b3ad744f89537008224bab2c0220436f1e77d23d15d51fb277eafd198d1f3c987e595d164f6bdb3045f48d864e11412102e2736bd41f01f459a67e80be9f0e771910ea53238e0ebb49628c053868d2044effffffff0360e4010000000000ad08626f6f7374706f777504000000002079765976714ac155f4f6a312b4debf890830287b40298641b4f035c400047e9404d8ff271d000425825088007e7c557a766b7e52796b557a8254887e557a8258887e7c7eaa7c6b7e7e7c8254887e6c7e7c8254887eaa01007e816c825488537f7681530121a5696b768100a0691d00000000000000000000000000000000000000000000000000000000007e6c539458959901007e819f6976a96c88ac00000000000000002f006a2231487948587459577947655072485669736e4e645339333156743643716f7555795a0972656c6179782e696f18722800000000001976a9142e011ac84c7373a793300f797b45def0a85a46b188ac00000000"
    },
    {
      "redeem":"01000000022683dedcf95c2b2b338d4f8dc7c0990362d74b2b06a164486b4fe802adbbe96e000000009747304402201e8ed2fc633998254e06621c443103e7baf112f6105b4275efa93c545e61fa5502207c4db443dc6e668b0b4e35fabe61949a887f941dc418862cbc4fcd6725b264f0412102f7cb3418d5e188a3984d4ab184a45b8d6df090e00527fafa310b166cc98dbe95042e3e05000413e0d263089891298de23c1515040417f2ce14e2db8bda89e1c7f85df8c75227818c654c035f1fffffffff059d6ea22a6339eee9687dc10aca68d2e501e9d6e67ca008346ccfa5304cc2ce00000000974730440220665755970ff82431b79c4977666b6209491757ba1f2d94f8ea62c38bac22e14102207ba8487423cd2e3c898f14a83b77b9500072a7004b5ca3e236e60ffa7d195f17412102f7cb3418d5e188a3984d4ab184a45b8d6df090e00527fafa310b166cc98dbe95042e3e05000413e0d263089891298de23c1515040417f2ce14e2db8bda89e1c7f85df8c75227818c654c035f1fffffffff01aac80300000000001976a914ec50088a9271abe3eab7cc66ae390028ab083a5088ac00000000", "spend":"0100000001c89e6a2783b895013dffba7a81bdf04970fbca9953ae6443dc92734195a1ec9e020000006a47304402204e743fe3e0e4c4597ca19f8c6cc8a347b1dd9941f421a0ebb90bc6df6693ba940220197bd9563dbd1bd3953df5a49e1b20495d3324b2c70c96886f372534bc227310412103076f82b48542907b10491d30671d7ba5b0f03bf3fe84c58e9f3ab57fea7e7326ffffffff0a60e4010000000000ad08626f6f7374706f7775040000000020d52937b93079c92ba26384200c258fa54ce1cb37cde653a73d4e4270b7be46f504d8ff271d0004d7832115007e7c557a766b7e52796b557a8254887e557a8258887e7c7eaa7c6b7e7e7c8254887e6c7e7c8254887eaa01007e816c825488537f7681530121a5696b768100a0691d00000000000000000000000000000000000000000000000000000000007e6c539458959901007e819f6976a96c88ac00000000000000002f006a2231487948587459577947655072485669736e4e645339333156743643716f7555795a0972656c6179782e696f04a00500000000001976a914914b028be8b510c00b0eb5b491e31d0705d906ee88ac03a00500000000001976a914914b028be8b510c00b0eb5b491e31d0705d906ee88ac1ea00500000000001976a914914b028be8b510c00b0eb5b491e31d0705d906ee88ac1fa00500000000001976a914914b028be8b510c00b0eb5b491e31d0705d906ee88acfc9f0500000000001976a914914b028be8b510c00b0eb5b491e31d0705d906ee88ac10a00500000000001976a914914b028be8b510c00b0eb5b491e31d0705d906ee88acfe9f0500000000001976a914914b028be8b510c00b0eb5b491e31d0705d906ee88ac29a10500000000001976a914914b028be8b510c00b0eb5b491e31d0705d906ee88ac00000000"
    },
    {
      "redeem":"010000000238a411a0d78b1531c607d3bca18bbf79905d3c97c369084490efcae723424a540000000097473044022059bad3883f8b21520908e5ed249df25b75ac48dde0f15dd76c91289b2caaf1be02203c009ce5706aa629fb54bb81757326a2c321b862397a324ac89d5edf14b0e050412102f7cb3418d5e188a3984d4ab184a45b8d6df090e00527fafa310b166cc98dbe9504a8ce190004b476c46308b29cc5f4daa05c38041ddf8e8e14e2db8bda89e1c7f85df8c75227818c654c035f1fffffffff400c6868c7b8a016d963d39cce48bcec33f460fe6c5fea16d656bfda36210ff1000000009747304402204d9ee07cb58ffe1be01b3ed2d7c736329a7044c6b323c52d4f51f4e0bda86e57022000c850dd4002cbcf8afd1bdd15baecf9c4f0b011fd1e72acb8adc0a365b0135d412102f7cb3418d5e188a3984d4ab184a45b8d6df090e00527fafa310b166cc98dbe9504a8ce190004b476c46308b29cc5f4daa05c38041ddf8e8e14e2db8bda89e1c7f85df8c75227818c654c035f1fffffffff01aac80300000000001976a914ec50088a9271abe3eab7cc66ae390028ab083a5088ac00000000", "spend":"0100000001bf75dfd564dfd93139ed6550319a75971ba77e9f507bdd53466d8e1111a033b2030000006b483045022100c7b81af8351e724a7f801f08e8d6351ff8e97cd1d9832a058bdeccb13a51c44f02206a579f2c9cbf8c7b66419c62790689ff69497172ba872d528ab9080bd8c5dd18412102e2736bd41f01f459a67e80be9f0e771910ea53238e0ebb49628c053868d2044effffffff0360e4010000000000ad08626f6f7374706f777504000000002079765976714ac155f4f6a312b4debf890830287b40298641b4f035c400047e9404d8ff271d0004dfe809da007e7c557a766b7e52796b557a8254887e557a8258887e7c7eaa7c6b7e7e7c8254887e6c7e7c8254887eaa01007e816c825488537f7681530121a5696b768100a0691d00000000000000000000000000000000000000000000000000000000007e6c539458959901007e819f6976a96c88ac00000000000000002f006a2231487948587459577947655072485669736e4e645339333156743643716f7555795a0972656c6179782e696ffe96f501000000001976a9142e011ac84c7373a793300f797b45def0a85a46b188ac00000000"
    },
    {
      "redeem":"010000000234f15457aafa2c39707fa76f62e64c4dcf105ee5fd62a2b546a566936ff4044f0000000097473044022016943606943a8740eb2826ad8512eab8ec567d3972eb2c362b86032b5363acfb0220673371c2361bfa61e31a6f44a3c92b267dc620f5e6bfa56c7c7b1ae716b7fbf5412102f7cb3418d5e188a3984d4ab184a45b8d6df090e00527fafa310b166cc98dbe9504b0cb220004bb77c46308278cd1fb7e291110044fd68d0114e2db8bda89e1c7f85df8c75227818c654c035f1fffffffff016f5f753ff591e9a5b2a267191942dd2e8e893715f1c09528d94ca7adb37b98000000009747304402207aca2250367def6b15bf1010ac72fc1d5ea98bf0da6072a5f6d6dffc43f56e1c02200e25d6db6cd98e39c1056d92eabda05db8f3f38ad3f6d915dc03f3a5c655c3eb412102f7cb3418d5e188a3984d4ab184a45b8d6df090e00527fafa310b166cc98dbe9504b0cb220004bb77c46308278cd1fb7e291110044fd68d0114e2db8bda89e1c7f85df8c75227818c654c035f1fffffffff01aac80300000000001976a914ec50088a9271abe3eab7cc66ae390028ab083a5088ac00000000", "spend":"01000000013d4fb905fe69fa9477238ff72c3bda958216265112be82375beb7caed50928ce020000006a47304402206683e5fd1d6ef0f434f961e5690b72c7f5a0cca568f52b8d5518069729ce10780220125d2c707ef56976eeb2a0e21d662b7a8d526aa2fd84d6e5f3d859125cc90de1412102e2736bd41f01f459a67e80be9f0e771910ea53238e0ebb49628c053868d2044effffffff0360e4010000000000ad08626f6f7374706f77750400000000200b6c58792256118ca5cf079a096afe2a3cbc1e01839f90e7dd0d4a52cac79ca804d8ff271d0004910b4bcf007e7c557a766b7e52796b557a8254887e557a8258887e7c7eaa7c6b7e7e7c8254887e6c7e7c8254887eaa01007e816c825488537f7681530121a5696b768100a0691d00000000000000000000000000000000000000000000000000000000007e6c539458959901007e819f6976a96c88ac00000000000000002f006a2231487948587459577947655072485669736e4e645339333156743643716f7555795a0972656c6179782e696fc1cbf401000000001976a9142e011ac84c7373a793300f797b45def0a85a46b188ac00000000"
    },
    {
      "redeem":"01000000020b8b5393a850a4f3a526fa4bcc72a04713eb4bdd8a9aacc9749e71a8195960070000000097473044022072bd9ba8274c600361131e34a12fcb0b487223ba4334ee69c1f97573aaa1995e02201fcfee6fcc6efba888fa105f4d813e69c077702d04d94f30f47b190a18be2401412102f7cb3418d5e188a3984d4ab184a45b8d6df090e00527fafa310b166cc98dbe9504f3a155000465d4ce6308526f805062e5a3ec04a5761ca714e2db8bda89e1c7f85df8c75227818c654c035f1fffffffff871152ad143b338efe1e5bcd9391f18702c5d3795ee9c89f5b6a21fa152ef152000000009848304502210096dbc4d8fcd5027161447dacf81409d12c98e4a802766415352e392d1e8d060102206ac47923d3600469dd46f26967b1d0c261670df344de7a39f164c8478836348f412102f7cb3418d5e188a3984d4ab184a45b8d6df090e00527fafa310b166cc98dbe9504f3a155000465d4ce6308526f805062e5a3ec04a5761ca714e2db8bda89e1c7f85df8c75227818c654c035f1fffffffff01aac80300000000001976a914ec50088a9271abe3eab7cc66ae390028ab083a5088ac00000000", "spend":"0100000001c63eb9c5d340f574104b5eafa952810f307a759e65fae10a68f5aab90933a0e4020000006a47304402207e7a4f301ab9c50dfcfa441809384180094bf863b686d5b68f1b7ecf7ac6060302206e452ab7d949e06270a273b4f36570c9170c30e6bc9b221d3b8ce0f875902aae412102e2736bd41f01f459a67e80be9f0e771910ea53238e0ebb49628c053868d2044effffffff0360e4010000000000ad08626f6f7374706f777504000000002020afa37726b8add1c1ddec22b30ab1b0ce9beeba8c59cb128b9ea124c46e052004d8ff271d0004a6fee6bf007e7c557a766b7e52796b557a8254887e557a8258887e7c7eaa7c6b7e7e7c8254887e6c7e7c8254887eaa01007e816c825488537f7681530121a5696b768100a0691d00000000000000000000000000000000000000000000000000000000007e6c539458959901007e819f6976a96c88ac00000000000000002f006a2231487948587459577947655072485669736e4e645339333156743643716f7555795a0972656c6179782e696fb71d3900000000001976a9142e011ac84c7373a793300f797b45def0a85a46b188ac00000000"
    },
    {
      "redeem":"010000000250e2ce472bef1858e716951d266c5e7f4bb720d5b73b8e55192ff94943e8d390000000009747304402204d1080649d9e896003ee04dfe66d4118c124d4d24f57dcd254b9a781a54f8361022074a92e4cea15182603a8316942f9a9952fa842069142f3d399458fdf1ac3f69f412103926fc4d5806b70f5973384a87d07cec9b90f99e44eae1fae68cea69404ae8be304e30136000480dfa563085e3ee26b6c0bdcd704bb96b4bb14241b1645efcc47e0f74eab3133c3300140f1fe2cffffffffd507193fb40c5db0f8aaaff46bc14d18418c0cf8a028f2d658b30c33d21707b70000000098483045022100d08cdd491714370079877a98a52f11667e03250e02b4caa89c155b421e9442fc02201a7a83ee1a60d60e428eb011b1ebcc6944bed49ef5764b7dcdfdb1a89ffc8d36412103926fc4d5806b70f5973384a87d07cec9b90f99e44eae1fae68cea69404ae8be304e30136000480dfa563085e3ee26b6c0bdcd704bb96b4bb14241b1645efcc47e0f74eab3133c3300140f1fe2cffffffff01aac80300000000001976a9141402f0ea4fb8cb9f0bf5629da25743b4576f35e788ac00000000", "spend":"0100000001721a01d9237c1a23db0645b63e90a7fe1bc4957de09acfec2e7664021c1ecd8c060000006a4730440220748f3eddc0079976e7d3676e2aaca3547f638a8000249d0bfc2b37e3536121f002201f5455644832e01607f09e4ba983142c838bddac242b8a316f729d915edec76541210381ca796dba9f4d3bd09bd4df28ea2e86ca43819aae4599bff9ba4cc3d3cf5d6effffffff0360e4010000000000ad08626f6f7374706f777504000000002094546cf8780cffcbbded1db50fc02ef3b259be317a95924ece512b746f3be6c304d8ff271d00047f1689ec007e7c557a766b7e52796b557a8254887e557a8258887e7c7eaa7c6b7e7e7c8254887e6c7e7c8254887eaa01007e816c825488537f7681530121a5696b768100a0691d00000000000000000000000000000000000000000000000000000000007e6c539458959901007e819f6976a96c88ac00000000000000002f006a2231487948587459577947655072485669736e4e645339333156743643716f7555795a0972656c6179782e696fcd890000000000001976a9146c47002bc3c6cd85a833f5c15c8305b36591c38b88ac00000000"
    }
  ]

  it("should read the transactions correctly and verify the proof", async () => {
    for (const proof of proofs) {
      const jobs = index.BoostPowJob.fromTransactionGetAllOutputs(index.bsv.Transaction(proof.spend))
      expect(jobs.length).to.equal(1)
      const solution = index.BoostPowJobProof.fromTransaction(index.bsv.Transaction(proof.redeem))
      expect(solution).to.not.equal(undefined)
    }
  })
})

describe("redeem output test ", () => {
  const categoryHex = "d2040000"

  const contentHex = index.BoostUtilsHelper.stringToBuffer(
    "hello animal", 32).reverse().toString("hex")

  const difficulty = 0.0001

  const tagHex = new Buffer("this is a tag", "ascii").toString("hex")

  const dataHex = new Buffer("this is more additionalData", "ascii").toString("hex")

  const userNonceHex = "c8010000"

  const extraNonce1 = index.UInt32Big.fromHex("02000000")

  const extraNonce2 = index.Bytes.fromHex("0000000300000003")

  const time = index.UInt32Little.fromHex("12300009")

  const generalPurposeBits = index.Int32Little.fromHex("ffffffff")

  let nonceV1 = index.UInt32Little.fromNumber(151906)
  let nonceV2 = index.UInt32Little.fromNumber(305455)

  let key = index.bsv.PrivateKey.fromWIF("KwKYRBpVWEYdQeA4uRGAu959BN4M1WpaTuetwsoBYES8CrVkxfLt")
  let pubkey = key.toPublicKey()
  let minerPubKeyHex = pubkey.toHex()
  let minerPubKeyHashHex = index.bsv.Address.fromPublicKey(pubkey, key.network).toObject().hash

  let satoshis = 7500
  let txid = index.Digest32.fromHex("abcdef00112233445566778899abcdefabcdef00112233445566778899abcdef")
  let vout = 2

  const puzzleBountyV1 = new index.Puzzle(
    new index.Output(
      index.BoostPowJob.fromObject({
        category: categoryHex,
        content: contentHex,
        diff: difficulty,
        tag: tagHex,
        additionalData: dataHex,
        userNonce: userNonceHex,
      }), satoshis, txid, vout), key)

  const puzzleBountyV2 = new index.Puzzle(
    new index.Output(
      index.BoostPowJob.fromObject({
        category: categoryHex,
        content: contentHex,
        diff: difficulty,
        tag: tagHex,
        additionalData: dataHex,
        userNonce: userNonceHex,
        useGeneralPurposeBits: true
      }), satoshis, txid, vout), key)

  const puzzleContractV1 = new index.Puzzle(
    new index.Output(
      index.BoostPowJob.fromObject({
        category: categoryHex,
        content: contentHex,
        diff: difficulty,
        tag: tagHex,
        additionalData: dataHex,
        userNonce: userNonceHex,
        minerPubKeyHash: minerPubKeyHashHex,
      }), satoshis, txid, vout), key)

  const puzzleContractV2 = new index.Puzzle(
    new index.Output(
      index.BoostPowJob.fromObject({
        category: categoryHex,
        content: contentHex,
        diff: difficulty,
        tag: tagHex,
        additionalData: dataHex,
        userNonce: userNonceHex,
        minerPubKeyHash: minerPubKeyHashHex,
        useGeneralPurposeBits: true
      }), satoshis, txid, vout), key)

  let solutionV1 = new index.work.Solution(time, extraNonce1, extraNonce2, nonceV1)

  let solutionV2 = new index.work.Solution(time, extraNonce1, extraNonce2, nonceV2, generalPurposeBits)

  it("should make valid proofs from puzzles and solutions", async () => {
    expect(new index.work.Proof(puzzleBountyV1.workPuzzle, solutionV1).valid()).to.eql(true)
    expect(new index.work.Proof(puzzleBountyV2.workPuzzle, solutionV2).valid()).to.eql(true)
    expect(new index.work.Proof(puzzleContractV1.workPuzzle, solutionV1).valid()).to.eql(true)
    expect(new index.work.Proof(puzzleContractV2.workPuzzle, solutionV2).valid()).to.eql(true)
  })

  // now we create the redemption transaction.

  let txRedeemBountyV1 = new index.bsv.Transaction()
  let txRedeemBountyV2 = new index.bsv.Transaction()
  let txRedeemContractV1 = new index.bsv.Transaction()
  let txRedeemContractV2 = new index.bsv.Transaction()

  txRedeemBountyV1.addOutput(new index.bsv.Transaction.Output({
    script: index.bsv.Script(new index.bsv.Address("13wgYHWXXwgLsSQLQzb4s24SL5jScuYujy")),
    satoshis: satoshis - 517
  }))

  txRedeemBountyV2.addOutput(new index.bsv.Transaction.Output({
    script: index.bsv.Script(new index.bsv.Address("13wgYHWXXwgLsSQLQzb4s24SL5jScuYujy")),
    satoshis: satoshis - 517
  }))

  txRedeemContractV1.addOutput(new index.bsv.Transaction.Output({
    script: index.bsv.Script(new index.bsv.Address("13wgYHWXXwgLsSQLQzb4s24SL5jScuYujy")),
    satoshis: satoshis - 517
  }))

  txRedeemContractV2.addOutput(new index.bsv.Transaction.Output({
    script: index.bsv.Script(new index.bsv.Address("13wgYHWXXwgLsSQLQzb4s24SL5jScuYujy")),
    satoshis: satoshis - 517
  }))

  txRedeemBountyV1.addInput(
    new index.bsv.Transaction.Input({
      output: new index.bsv.Transaction.Output({
        script: puzzleBountyV1.output.script.toScript(),
        satoshis: satoshis
      }),
      prevTxId: txid.buffer,
      outputIndex: vout,
      script: index.bsv.Script.empty()
    })
  )

  txRedeemBountyV2.addInput(
    new index.bsv.Transaction.Input({
      output: new index.bsv.Transaction.Output({
        script: puzzleBountyV2.output.script.toScript(),
        satoshis: satoshis
      }),
      prevTxId: txid.buffer,
      outputIndex: vout,
      script: index.bsv.Script.empty()
    })
  )

  txRedeemContractV1.addInput(
    new index.bsv.Transaction.Input({
      output: new index.bsv.Transaction.Output({
        script: puzzleContractV1.output.script.toScript(),
        satoshis: satoshis
      }),
      prevTxId: txid.buffer,
      outputIndex: vout,
      script: index.bsv.Script.empty()
    })
  )

  txRedeemContractV2.addInput(
    new index.bsv.Transaction.Input({
      output: new index.bsv.Transaction.Output({
        script: puzzleContractV2.output.script.toScript(),
        satoshis: satoshis
      }),
      prevTxId: txid.buffer,
      outputIndex: vout,
      script: index.bsv.Script.empty()
    })
  )

  let sigtype = index.bsv.crypto.Signature.SIGHASH_ALL | index.bsv.crypto.Signature.SIGHASH_FORKID

  let flags = index.bsv.Script.Interpreter.SCRIPT_VERIFY_MINIMALDATA |
    index.bsv.Script.Interpreter.SCRIPT_ENABLE_SIGHASH_FORKID |
    index.bsv.Script.Interpreter.SCRIPT_ENABLE_MAGNETIC_OPCODES |
    index.bsv.Script.Interpreter.SCRIPT_ENABLE_MONOLITH_OPCODES

  let redeemBountyV1 = puzzleBountyV1.redeem(solutionV1, txRedeemBountyV1, 0, sigtype, flags)
  let redeemBountyV2 = puzzleBountyV2.redeem(solutionV2, txRedeemBountyV2, 0, sigtype, flags)
  let redeemContractV1 = puzzleContractV1.redeem(solutionV1, txRedeemContractV1, 0, sigtype, flags)
  let redeemContractV2 = puzzleContractV2.redeem(solutionV2, txRedeemContractV2, 0, sigtype, flags)

  it("should make valid Redeem objects.", async () => {
    expect(index.Job.tryValidateJobProof(puzzleBountyV1.output.script, redeemBountyV1)).to.not.eql(null)
    expect(index.Job.tryValidateJobProof(puzzleBountyV2.output.script, redeemBountyV2)).to.not.eql(null)
    expect(index.Job.tryValidateJobProof(puzzleContractV1.output.script, redeemContractV1)).to.not.eql(null)
    expect(index.Job.tryValidateJobProof(puzzleContractV2.output.script, redeemContractV2)).to.not.eql(null)
  })

  txRedeemBountyV1.inputs[0].setScript(redeemBountyV1.toScript())
  txRedeemBountyV2.inputs[0].setScript(redeemBountyV2.toScript())
  txRedeemContractV1.inputs[0].setScript(redeemContractV1.toScript())
  txRedeemContractV2.inputs[0].setScript(redeemContractV2.toScript())
  // we cannot do this test because we don't have a proper interpreter.
  /*
  it("should interpret the script and be valid", async () => {
    let bn = index.bsv.crypto.BN.fromNumber(satoshis)
    expect(puzzleBountyV1.output.script.toScript()).to.not.eql(undefined)
    index.bsv.Script.Interpreter.MAXIMUM_ELEMENT_SIZE = 0
    expect(index.bsv.Script.Interpreter().verify(
      redeemBountyV1.toScript(),
      puzzleBountyV1.output.script.toScript(),
      txRedeemBountyV1, 0, flags, bn)).to.eql(true)
    expect(index.bsv.Script.Interpreter().verify(
      redeemBountyV2.toScript(),
      puzzleBountyV2.output.script.toScript(),
      txRedeemBountyV2, 0, flags, bn)).to.eql(true)
    expect(index.bsv.Script.Interpreter().verify(
      redeemContractV1.toScript(),
      puzzleContractV1.output.script.toScript(),
      txRedeemContractV1, 0, flags, bn)).to.eql(true)
    expect(index.bsv.Script.Interpreter().verify(
      redeemContractV2.toScript(),
      puzzleContractV2.output.script.toScript(),
      txRedeemContractV2, 0, flags, bn)).to.eql(true)
  })*/

})
